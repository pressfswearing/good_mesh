import telebot
from dnevniklib.homeworks import Homeworks
from dnevniklib.student import Student

bot = telebot.TeleBot('6487833703:AAGL9V98CNDHPP7X7FWbYueOug3hstP84Lg')

@bot.message_handler(commands=['start'])
def start(message):
	bot.send_message(message.chat.id, 'Привет! Отправь /homeworks, если хочешь увидеть домашки, или /schedule, если хочешь увидеть расписание.')

@bot.message_handler(commands=['homeworks'])
def homeworks(message):
	date = bot.send_message(message.chat.id, 'Отправь дату, на которую хочешь увидеть домашки, в таком формате:\n2023-10-25')
	bot.register_next_step_handler(date, homeworks1)
def homeworks1(message):
	date = message.text
	student = Student(token="eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg")
	homework = Homeworks(Student(token='eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg'))
	homeworks_general = []
	homeworks = homework.get_homework_by_date(date)
	for i in range(len(homeworks)):
		homeworks_general.append(homeworks[i])
	for i in homeworks_general:
		bot.send_message(message.chat.id, i)

@bot.message_handler(commands=['schedule'])
def schedule(message):
	date = bot.send_message(message.chat.id, 'Отправь дату, на которую хочешь увидеть расписание, в таком формате:\n2023-10-25')
	bot.register_next_step_handler(date, schedule1)
def schedule1(message):
	date = message.text
	student = Student(token="eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg")
	homework = Homeworks(Student(token='eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg'))
	schedule_general = []
	schedule = homework.get_schedule(date)
	for i in range(len(schedule)):
		schedule_general.append(schedule[i])
	for i in schedule_general:
		bot.send_message(message.chat.id, i)

@bot.message_handler(commands=['marks'])
def marks(message):
	date = bot.send_message(message.chat.id, 'Отправь дату, на которую хочешь увидеть оценки, в таком формате:\n2023-10-25')
	bot.register_next_step_handler(date, marks1)
def marks1(message):
	date = message.text
	student = Student(token="eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg")
	homework = Homeworks(Student(token='eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg'))
	marks_general = []
	marks = homework.get_marks(date)
	for i in range(len(marks) - 1):
		marks_general.append(marks[i])
	for i in marks_general:
		bot.send_message(message.chat.id, i)

@bot.message_handler(commands=['trimester_marks'])
def trimester_marks(message):
	trimester = bot.send_message(message.chat.id, 'Введи номер триместра, на который хочешь посмотерть средние баллы.\n1 - 1 триместр\n2 - 2 триместр\n3 - 3 триместр.')
	bot.register_next_step_handler(trimester, trimester_marks1)
def trimester_marks1(message):
	trimester = str(int(message.text )- 1)
	student = Student(token='eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg')
	homework = Homeworks(Student(token='eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyODg2Mzg0Iiwic2NwIjoib3BlbmlkIHByb2ZpbGUiLCJhdWQiOiIyOjEiLCJuYmYiOjE2OTg4NDY2OTEsIm1zaCI6ImRkM2IwN2ZmLWU1NTEtNGY1Ny05NzRhLTYwYWE5YTQwN2RjYSIsImF0aCI6InN1ZGlyIiwiaXNzIjoiaHR0cHM6XC9cL3NjaG9vbC5tb3MucnUiLCJybHMiOiJ7MTpbMTgzOjE2OltdLDMwOjQ6W10sNDA6MTpbXSwyMDoyOltdXX0iLCJleHAiOjE2OTk3MTA2OTEsImlhdCI6MTY5ODg0NjY5MSwianRpIjoiYjEyMThjN2ItYjcxNC00NTRjLWExOGMtN2JiNzE0MTU0YzRmIiwic3NvIjoiYWQ5MjBlYTUtN2VhZS00ZWFjLTg1YmEtY2E0ZjczM2RjMDY0In0.UCRh5QpvVogRA4ghCDHK3R6r0uZ7YhlbA_jBoO_v4IVOLpX-2GJ6A2_-EcHT3UcdkdfA9uYbdsJX1Utx74leqTzTCBFt0HLGTGsEwFPcilIDFcyYFJkFxuHvQQH0B6mqM1LwqnvtgQ4V1MLIUdmk8jgP9RUVpBuqAwHXqC7ar-_qB5n_8nygTdHIzkcxO3dSTVbWfJwgLRIhY0GZ2pbJ6XZpr7L6S1cdWF1sftE_PavuEJ4wibN1v0kEBghriZXP7WVmL1z2rOiXpmKeeYrqz36UQXuGRGohYew3vqv6RraEuAMG_7R_jynbFcGvo5AghIahWhQQN8959Kn2eG7IIg'))
	trimes_ter_marks = homework.get_trimester_marks(trimester)
	for i in range(len(trimes_ter_marks)):
            bot.send_message(message.chat.id, str(trimes_ter_marks[i]['name']) + ': ' + str(trimes_ter_marks[i]['mark']))

bot.polling(interval = 0, none_stop = True)